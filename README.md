# Unstringify

[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg)](http://makeapullrequest.com)

## ‚òùÔ∏è What?

- `unstringify` (CLI): Code generator for strong-typing localizable strings.
- `Unstringified` (module): Strong-typed localizable strings static source code.

## ü§î Why?

It makes your localized strings code:

- compile time checked,
- strong typed,
- autocompletable by Xcode.

## üõ† How?

### Installation

There are several methods to install Unstringify:

- Via [CocoaPods](https://cocoapods.org)
- Via [Swift Package Manager](https://swift.org/package-manager)
- Others:
    - Download the ZIP for the [latest release](https://github.com/metrolab/Unstringify/releases/latest)
    - Via [Mint](https://github.com/yonaskolb/Mint) (system-wide installation)
    - Compile from [source](https://github.com/metrolab/Unstringify.git) (only recommended if you need features from master or want to test a PR)

#### CocoaPods

Add `unstringify` specs to your `Podfile`:

```ruby
pod 'Unstringify'
```

Add `Unstringified` as dependency in the podspec of the module that contains the strings files:

```ruby
s.dependency 'Unstringified'
```
**Note:** *If your app is not modularized, simply add `pod 'Unstringified'` to your `Podfile` too.*

Add a Build Phase that generates the code for the `Unstringified` enumerations:

```sh
"$PODS_ROOT/Unstringify/unstringify" "$SRCROOT/path/to/module/en.lproj/Localizable.strings" "$SRCROOT/path/to/module/Unstringified.generated.swift"
```

#### Swift Package Manager

Declare `Unstringify` dependency in your `Package.swift` file:

```swift
dependencies: [
    .package(url: "https://github.com/metrolab/Unstringify", from: "0.1.0"),
]
```

Execute the CLI passing as arguments the *input strings file* and the *path to generated output file*:

```sh
swift run unstringify path/to/module/en.lproj/Localizable.string path/to/module/Unstringified.generated.swift
```

In order to use the generated file, you will need to *link* `Unstringified` to the module that contains the generated file and the original strings files.  

### Usage

CLI usage:

```
$ ./unstringify
Usage: ./unstringify inputPath outputPath
```

Input (e.g. `en.lproj/Localizable.strings`):

```
"form_title" = "Contact";
"form_name_field" = "Name:";
"form_name_field_max_length" = "Maximum length is %d characters.";
"form_name_field_description" = "Enter your <b>full name</b>";
```

Output (e.g. `Unstringified.generated.swift`):

```swift
//  Generated by Unstringify.
//  DO NOT EDIT!

import Foundation
import Unstringified

private final class _Unstringified {}

extension Unstringified {
    public var localizableStringsTableName: String? {
        return nil
    }

    public var localizableStringsBundle: Bundle? {
        let _UnstringifiedBundle = Bundle(for: _Unstringified.self)
        guard _UnstringifiedBundle.bundleIdentifier != Bundle.main.bundleIdentifier else {
            return Bundle.main
        }
        let bundleURL = _UnstringifiedBundle.bundleURL
        let bundleName = bundleURL.lastPathComponent
        let resource = (bundleName as NSString).deletingPathExtension
        guard let path = _UnstringifiedBundle.path(forResource: resource, ofType: "bundle") else {
            return nil
        }
        return Bundle(path: path)
    }
}

extension String {    
    public enum Text: String, Unstringified {
        public typealias StringType = String
        case text_localized_1, text_localized_2, text_localized_3, text_localized_4
    }
    
    public enum Format: Unstringified {
        public typealias StringType = String
        case üëª(_: Int)
    }
    
    public enum RichText: String, Unstringified {
        public typealias StringType = NSAttributedString
        case üëª
    }
    
    public enum RichFormat: Unstringified {
        public typealias StringType = NSAttributedString
        case üëª(_: Int)
    }
}

```

### Customization

You can customize `localizableStringsTableName` and `localizableStringsBundle` for each enum (`Text`, `Format`, `RichText`, `RichFormat`) by reimplementing them in an extension:

```swift
extension Text {
    public var localizableStringsTableName: String? {
        return "xxx"
    }
}
```

### Examples

See [Examples directory](Examples).

## üìñ License

Unstringify is released under the MIT license. See `LICENSE` for details.

# Alternatives

- <https://github.com/mac-cain13/R.swift>
- <https://github.com/bannzai/ResourceKit>
- <https://github.com/kaandedeoglu/Shark>
- <https://github.com/SwiftGen/SwiftGen>
